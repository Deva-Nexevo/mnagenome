import { Component, Input, OnInit } from '@angular/core';
import * as Highcharts from 'highcharts';
@Component({
  selector: 'pie-chart',
  templateUrl: './piechart.component.html',
})
export class PieChartComponent implements OnInit {
  public chartOptions: Highcharts.Options = {};
  @Input() data: any = [];
  @Input() name: any = '';
  @Input() dropDownData: any = [];
  @Input() db_name: any = [];
  @Input() colorValue: any = '';
  color = [
    [
      '#FF6B6B',
      '#FF00E4',
      '#FFDAB9',
      '#0F52BA',
      '#FE8F8F',
      '#4B3869',
      '#911F27',
      '#FFF47D',
      '#A9E4D7',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
      '#C2F784',
      '#d3d3d3',
      '#6C5B7B',
      '#F7DDA4',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#53CDD8',
      '#AE00FB',
      '#93DEFF',
      '#665C84',
      '#002F35',
      '#EADCA6',
      '#779977',
      '#A6D0E4',
      '#C4BBF0',
    ],
    [
      '#D9CAB3',
      '#0F52BA',
      '#FCFFA6',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
      '#FF00E4',
      '#FFC947',
      '#316B83',
      '#54436B',
      '#FE8F8F',
      '#4B3869',
      '#C2F784',
      '#d3d3d3',
      '#6C5B7B',
      '#F7DDA4',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#53CDD8',
      '#AE00FB',
      '#93DEFF',
      '#665C84',
      '#002F35',
      '#EADCA6',
      '#779977',
      '#A6D0E4',
      '#C4BBF0',
    ],
    [
      '#542E71',
      '#FB3640',
      '#FDCA40',
      '#A799B7',
      '#D8F8B7',
      '#FF9A8C',
      '#CE1F6A',
      '#F0E3CA',
      '#FCFFA6',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
      '#C2F784',
      '#d3d3d3',
      '#6C5B7B',
      '#F7DDA4',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#53CDD8',
      '#AE00FB',
      '#93DEFF',
      '#665C84',
      '#002F35',
      '#EADCA6',
      '#779977',
      '#A6D0E4',
      '#C4BBF0',
    ],
    [
      '#FCFFA6',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
      '#FF00E4',
      '#FFC947',
      '#316B83',
      '#54436B',
      '#345B63',
      '#D8F8B7',
      '#FF9A8C',
      '#CE1F6A',
      '#C2F784',
      '#d3d3d3',
      '#6C5B7B',
      '#F7DDA4',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#53CDD8',
      '#AE00FB',
      '#93DEFF',
      '#665C84',
      '#002F35',
      '#EADCA6',
      '#779977',
      '#A6D0E4',
      '#C4BBF0',
    ],
    [
      '#420516',
      '#A8D8EAo',
      '#AA96DA',
      '#FCBAD3',
      '#A8D8EA',
      '#FCFFA6',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
      '#FF00E4',
      '#FFC947',
      '#316B83',
      '#C2F784',
      '#d3d3d3',
      '#6C5B7B',
      '#F7DDA4',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#53CDD8',
      '#AE00FB',
      '#93DEFF',
      '#665C84',
      '#002F35',
      '#EADCA6',
      '#779977',
      '#A6D0E4',
      '#C4BBF0',
    ],
    [
      '#7D1935',
      '#420516',
      '#B42B51',
      '#71EFA3',
      '#E63E6E',
      '#FFC947',
      '#54436B',
      '#345B63',
      '#420516',
      '#A8D8EAo',
      '#AA96DA',
      '#FCBAD3',
      '#A8D8EA',
      '#FCFFA6',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#C2F784',
      '#d3d3d3',
      '#6C5B7B',
      '#F7DDA4',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#53CDD8',
      '#AE00FB',
      '#93DEFF',
      '#665C84',
      '#002F35',
      '#EADCA6',
      '#779977',
      '#A6D0E4',
      '#C4BBF0',
    ],
    [
      '#D4ECDD',
      '#38A3A5',
      '#FEC260',
      '#3E00FF',
      '#AE00FB',
      '#334756',
      '#911F27',
      '#3EDBF0',
      '#C2F784',
      '#d3d3d3',
      '#6C5B7B',
      '#F7DDA4',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#53CDD8',
      '#AE00FB',
      '#93DEFF',
      '#665C84',
      '#002F35',
      '#EADCA6',
      '#779977',
      '#A6D0E4',
      '#C4BBF0',
      '#D5C455',
      '#000000',
      '#3C2F3D',
      '#523F79',
      '#5AA469',
      '#183661',
      '#542E71',
      '#FB3640',
      '#FDCA40',
      '#A799B7',
      '#D8F8B7',
      '#FF9A8C',
    ],
    [
      '#EFEFEF',
      '#2D2424',
      '#E63E6D',
      '#FACE7F',
      '#6F4C5B',
      '#A45D5D',
      '#B45D5D',
      '#3EDBF0',
      '#C2F784',
      '#d3d3d3',
      '#6C5B7B',
      '#F7DDA4',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#53CDD8',
      '#AE00FB',
      '#93DEFF',
      '#665C84',
      '#002F35',
      '#EADCA6',
      '#779977',
      '#A6D0E4',
      '#C4BBF0',
      '#D5C455',
      '#000000',
      '#3C2F3D',
      '#523F79',
      '#5AA469',
      '#183661',
      '#542E71',
      '#FB3640',
      '#FDCA40',
      '#A799B7',
      '#D8F8B7',
      '#FF9A8C',
    ],
    [
      '#7579E7',
      '#A799B7',
      '#04009A',
      '#88FFF7',
      '#F7E6AD',
      '#FCFFA6',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
      '#FF00E4',
      '#FFC947',
      '#316B83',
      '#54436B',
      '#345B63',
      '#D8F8B7',
      '#FF9A8C',
      '#CE1F6A',
      '#C2F784',
      '#d3d3d3',
      '#6C5B7B',
      '#F7DDA4',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#EFEFEF',
      '#2D2424',
      '#E63E6D',
      '#FACE7F',
    ],
    [
      '#064420',
      '#986D8E',
      '#D7E9F7',
      '#393E46',
      '#3797A4',
      '#D2F6C5',
      '#EFF48E',
      '#FFC1F3',
      '#F7F7EE',
      '#222831',
      '#F17808',
      '#4CD3C2',
      '#E71414',
      '#C4FB6D',
      '#EFA8E4',
      '#95389E',
      '#FF6B6B',
      '#FF00E4',
      '#FFDAB9',
      '#0F52BA',
      '#FE8F8F',
      '#4B3869',
      '#911F27',
      '#FFF47D',
      '#A9E4D7',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
    ],
    [
      '#BBE4E9',
      '#3C3B5C',
      '#7B3C59',
      '#ECDBBA',
      '#DB6400',
      '#633A82',
      '#EFF48E',
      '#FFC1F3',
      '#F7F7EE',
      '#222831',
      '#F17808',
      '#4CD3C2',
      '#E71414',
      '#C4FB6D',
      '#EFA8E4',
      '#95389E',
      '#FF6B6B',
      '#FF00E4',
      '#FFDAB9',
      '#0F52BA',
      '#FE8F8F',
      '#4B3869',
      '#911F27',
      '#FFF47D',
      '#A9E4D7',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
    ],
    [
      '#64C9CF',
      '#F7DBF0',
      '#7C83FD',
      '#E6DDC6',
      '#393E46',
      '#EEEEEE',
      '#834C69',
      '#115173',
      '#252525',
      '#C400C6',
      '#003F5C',
      '#4CD3C2',
      '#E71414',
      '#C4FB6D',
      '#EFA8E4',
      '#95389E',
      '#FF6B6B',
      '#FF00E4',
      '#FFDAB9',
      '#0F52BA',
      '#FE8F8F',
      '#4B3869',
      '#911F27',
      '#FFF47D',
      '#A9E4D7',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
    ],
    [
      '#6E5773',
      '#393E46',
      '#3797A4',
      '#D2F6C5',
      '#EFF48E',
      '#FFC1F3',
      '#F7F7EE',
      '#222831',
      '#F17808',
      '#4CD3C2',
      '#EFA8E4',
      '#EA9085',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#53CDD8',
      '#AE00FB',
      '#93DEFF',
      '#665C84',
      '#002F35',
      '#EADCA6',
      '#779977',
      '#A6D0E4',
      '#C4BBF0',
      '#D5C455',
      '#000000',
      '#3C2F3D',
      '#523F79',
      '#5AA469',
      '#183661',
      '#542E71',
      '#FB3640',
      '#FDCA40',
      '#A799B7',
      '#D8F8B7',
      '#FF9A8C',
    ],
    [
      '#EFEFEF',
      '#2D2424',
      '#E63E6D',
      '#FACE7F',
      '#6F4C5B',
      '#A45D5D',
      '#B45D5D',
      '#C400C6',
      '#003F5C',
      '#F7F7EE',
      '#222831',
      '#F17808',
      '#4CD3C2',
      '#EFA8E4',
      '#EA9085',
      '#C06C84',
      '#E25822',
      '#C86F5E',
      '#53CDD8',
      '#AE00FB',
      '#93DEFF',
      '#665C84',
      '#002F35',
      '#EADCA6',
      '#779977',
      '#A6D0E4',
      '#C4BBF0',
      '#D5C455',
      '#000000',
      '#3C2F3D',
      '#523F79',
      '#5AA469',
      '#183661',
      '#3797A4',
      '#D2F6C5',
      '#EFF48E',
    ],
    [
      '#AACDBE',
      '#F4F7C5',
      '#FBC687',
      '#EA907A',
      '#BB596B',
      '#FFC4A3',
      '#C3EDEA',
      '#FE346E',
      '#05DFD7',
      '#B7472A',
      '#DAB8F3',
      '#EA7AD7',
      '#6E5773',
      '#003F5C',
      '#542E71',
      '#FB3640',
      '#FDCA40',
      '#A799B7',
      '#D8F8B7',
      '#FF9A8C',
      '#CE1F6A',
      '#F0E3CA',
      '#FCFFA6',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
      '#C2F784',
      '#d3d3d3',
    ],
    [
      '#AACDBE',
      '#F4F7C5',
      '#FBC687',
      '#EA907A',
      '#BB596B',
      '#FFC4A3',
      '#C3EDEA',
      '#FE346E',
      '#05DFD7',
      '#115173',
      '#B7472A',
      '#FCFFA6',
      '#C1FFD7',
      '#B5DEFF',
      '#CAB8FF',
      '#DBD0C0',
      '#FAEEE0',
      '#F9E4C8',
      '#F9CF93',
      '#FF5C58',
      '#FE8F8F',
      '#406343',
      '#E63E6E',
      '#FF00E4',
      '#FFC947',
      '#316B83',
      '#54436B',
      '#345B63',
      '#D8F8B7',
      '#FF9A8C',
      '#CE1F6A',
      '#C2F784',
      '#d3d3d3',
      '#6C5B7B',
      '#F7DDA4',
      '#A799B7',
    ],
  ];

  findValue(id: any) {
    return this.dropDownData.find((val: any) => val.id === id)[
      this.name.findName
    ];
  }
  ngOnInit(): void {
    const data: any = [];
    const totalNoOfResponse = this.data
      .map((item: any) => item.no_of_responses)
      .reduce((prev: any, curr: any) => prev + curr, 0);

    this.data.forEach((val: any, index: number) => {
      data.push({
        name: this.findValue(val[this.name.db_name]),
        y: val.no_of_responses / totalNoOfResponse,
        color: this.color[this.colorValue][index],
      });
    });

    this.chartOptions = {
      chart: {
        plotShadow: false,
        type: 'pie',
        width: '500',
        height: '300',
      },
      title: {
        text: '',
      },
      tooltip: {
        pointFormat: '{series.name}: {point.percentage:.1f}% of total',
      },
      accessibility: {
        point: {
          valueSuffix: '%',
        },
      },
      plotOptions: {
        pie: {
          allowPointSelect: true,
          cursor: 'pointer',
          dataLabels: {
            enabled: true,
            format: '{point.percentage:.1f} %',
          },
        },
      },
      credits: {
        enabled: false,
      },
      series: [
        {
          type: 'pie',
          name: this.name.name,
          colorByPoint: true,
          data: data,
          size: '100%',
        },
      ],
    };
  }

  Highcharts: typeof Highcharts = Highcharts;
}
